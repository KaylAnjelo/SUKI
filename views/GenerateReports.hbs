<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Generate Reports</title>
  <link rel="stylesheet" href="/css/style-page2.css" />
  <script src="/js/notifications.js" defer></script>
</head>
<body>
  <div class="container">
    <aside class="sidebar">
      <div class="logo">SUKI Incorporation</div>
      <nav class="nav">
        <a href="#" class="nav-item">Dashboard</a>
        <a href="#" class="nav-item active">Generate Reports</a>
        <a href="#" class="nav-item">Points Allocation</a>
        <a href="#" class="nav-item">Transactions</a>
        <a href="#" class="nav-item">User Redemptions</a>
        <a href="#" class="nav-item">User Management</a>
      </nav>
    </aside>

    <main class="main-content">
      <div class="header">
        <button class="add-store">Add Store</button>
        <div class="notif-container">
        <button id="notificationsBtn" class="notif-button">Notifications</button>
        <div id="notificationsDropdown" style="display: none;">
          <ul id="notificationsList"></ul>
        </div>
        </div>
          <form action="/logout" method="POST" style="display: inline;">
            <button type="submit" class="logout">Log out</button>
          </form>
      </div>
      <h1>Reports</h1>
      <div class="report-buttons">
        <button class="report-btn">Sales</button>
        <button class="report-btn">User Engagement</button>
        <button class="report-btn">Transaction Records</button>
      </div>
      <div class="support">
        <button class="support-btn">Support</button>
      </div>
    </main>
  </div>
</body>
<script>
  // Fetch logs and display them in the notifications dropdown
  document.getElementById('notificationsBtn').addEventListener('click', async () => {
    const response = await fetch('/notifications');
    const logs = await response.json();

    const notificationsList = document.getElementById('notificationsList');
    notificationsList.innerHTML = '';  // Clear existing notifications

    logs.forEach(log => {
      const listItem = document.createElement('li');
      // Assuming 'login_time' is a timestamp
      const formattedTime = new Date(log.login_time).toLocaleString();  // Format the timestamp
      listItem.textContent = `${log.admin_name} logged in at ${formattedTime}`;
      notificationsList.appendChild(listItem);
    });

    const dropdown = document.getElementById('notificationsDropdown');
    dropdown.style.display = 'block';  // Show the dropdown
  });
</script>
</html>
